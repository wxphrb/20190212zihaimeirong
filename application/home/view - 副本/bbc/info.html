<!--顶部导航-->{include file="public/header" /}<link href="__HOME__/css/fsgallery.css" type="text/css" rel="stylesheet"><script src="__HOME__/js/fs_forse.js" type="text/javascript"></script><style>    .d1 .qy{        background: url("__HOME__/img/qy_bg_06.png") no-repeat;        background-size: 100% 100%;        width: 1.1rem;        height: 0.32rem;        font-size: 0.22rem;        color: #ffffff;        padding-left: 0.36rem ;        margin-top: 0.18rem;        /*line-height: 0.32rem;*/        margin-left: 1.6rem;        margin-right: 0.12rem;    }    .details_btn{        position: inherit;        background: none;    }    .hot_cont .cont_d1:last-child{        border-bottom: none;    }    .details_btn a{        margin-top: 0.3rem;    }    img {max-width: 100%!important;}    .hot_t_content .t_div .right {        width: 3.3rem;    }    .hot_cont .cont_d1 {        padding: 0.25rem 0.25rem 0.3rem 0.25rem;    }    .hot_cont .cont_d1 {        padding-bottom: 0.6rem;    }    .hot_t_div1 {        border-bottom: 1px solid #f4f4f4 !important;    }    .rt_hf {        background: #ebebeb;        margin-top: 0.4rem;        height: 0.8rem;        padding: 0 0.25rem;    }    .rt_hf input {        float: left;        width: 5rem;        height: 0.8rem;        padding: 0 0.2rem;        border: none;        background: none;        font-size: 0.26rem;    }</style><body><div class="wrap">    <header>        <img src="__HOME__/img/back_btn_03.png" class="back_btn" onclick="javascript:history.go(-1)">        <p class="title">问答详情</p>        {if condition="$data['collection'] eq 0"}        <a href="#" class="sc"><img src="__HOME__/img/head_right_img.png" onclick="sc('{$data.id}',3)"></a>        {else/}        <a href="#" class="sc"><img src="__HOME__/img/my_img3.png" onclick="qx('{$data.collection_id}')"></a>        {/if}        <a onclick="share_btn()" class="fx"><img src="__HOME__/img/head_right_img1.png"></a>    </header>    <div class="hot_t_content hot_cont">        <div class="t_div">            {if condition="$data['hot_state'] eq 1"}            <div class="left">热</div>            {else/}            <div class="left_w">问</div>            {/if}            <div class="right">{$data.title}</div>            <!--赏logo-->            {if condition="$data['integral_num'] neq 0"}            <img src="__HOME__/img/question_logo_03.png" class="w_bg">            {/if}            <div class="jb">                <img src="__HOME__/img/jifen_03.png">                <span>{$data['integral_num']}</span>            </div>        </div>        <div class="layer1" onclick="fff()"             style="display:none;width: 100%;height: 100%;position: fixed;top: 0;left: 0;z-index: 100000"><img src="__HOME__/img/fenxiang.png" style="width: 100%;height: 100%">        </div>        <div class="answer_d cont_d1">            <div class="tx_name">                <img src="{$data['picurl']}" class="tx">                <p class="name">{$data['username']}</p>                <p class="time">{$data.create_time|date="Y-m-d H:i:s",###}</p>                <p class="ans_num"><img src="__HOME__/img/answer_logo_03.png"><span>{$data.answer_num}回答</span></p>            </div>            <p class="p1">{$data.content}</p>            {if condition="$data['picarr_type'] eq 1"}            <div class="center_div">                <ul class="thumbnails" id="gallery">                    {volist name="$data['picarr']" id="vo"}                    <li><a href="__ROOT__{$vo.img}"><img src="__ROOT__{$vo.img}" style="width: 111px;height: 111px;"></a></li>                    {/volist}                </ul>            </div>            {/if}            {if condition="$data['picarr_type'] eq 2"}            {volist name="$data['picarr']" id="vo"}            <video src="__ROOT__{$vo['img']}" controls="controls" style="width: 100%">                您的浏览器不支持 video 标签。            </video>            {/volist}            {/if}            <p class="ques_more" style="margin-top: 20px;">                {if condition="$id neq $user_id"}                    <a href="{:url('bbc/answerAdd',['id'=>$data['id']])}">                        <span>我有更好的回答</span>                    </a>                {else/}                    <span class="myhave">我有更好的回答</span>                {/if}            <img src="__HOME__/img/down_img_03.png"></p>        </div>        <script>            $('.myhave').click(function(){                var id = '{$data.id}';                $.ajax({                    url: "{:url('bbc/ques')}",                    type: 'post',                    dataType: 'html',                    data:{id:id},                    success:function(data){                        layer.msg('自己不能点击自己哦', {                            time: 1000 //2秒关闭（如果不配置，默认是3秒）                        })                    }                })            })        </script>        <!--一级回复-->        {volist name="$data['answer']" id="vo"}        <div class="hot_t_div1 cont_d1">            {if condition="$vo['status'] eq 1"}            <img src="__HOME__/img/zjda_img_02.png" alt=""                 style="width: 1.5rem;margin-left: -0.25rem;margin-bottom: 0.1rem; ">            {/if}            <div class="d1">                <img src="{$vo.picurl}" class="tx">                {if condition="$vo.anonymous eq 0"}                <p class="name">{$vo.username}</p>                {else/}                <p class="name">**{$vo.username|msubstr=2,4,'utf-8',false}</p>                {/if}                {switch name="vo.level_id" }                {case value="0"}{/case}                {case value="1"} <p class="qy"                                    style="background: url('__HOME__/img/qy_bg_06.png') no-repeat;background-size: 100% 100%;">                {$vo.level_title}</p>{/case}                {case value="2"} <p class="qy"                                    style="background: url('__HOME__/img/fl_style2_03.png') no-repeat;background-size: 100% 100%;">                {$vo.level_title}</p>{/case}                {default /}默认情况                {/switch}                <p class="time" style="float: left;margin-left: 0.15rem;">{$vo.create_time|date="Y-m-d H:i:s",###}</p>            </div>            <div class="d2">                <p>{$vo.content}</p>            </div>            <div class="bottom">                <ul>                    <li onclick="addlaud('{$vo.id}')"><img src="__HOME__/img/li_bottom_logo_7.png"><span va="1" id="num{$vo.id}">{$vo.praise}</span></li>                    <li><img src="__HOME__/img/li_bottom_logo_8.png" onclick="show_message(this)"><span>{$vo.reply_num}</span></li>                </ul>            </div>            <script>                function addlaud(id) {                    va = $('#num'+id).attr('va');                    if(va == 1){                        //点赞                        numval = $('#num'+id).html();                        $('#num'+id).text(parseInt(numval)+1);                        $('#num'+id).attr('va','2');                        $.ajax({                            url:"{:url('bbc/addlaud')}",                            type:"post",                            dataType:"html",                            data:{id:id},                            success:function(data){                                layer.msg('点赞成功', {time: 1000})                            }                        });                    }else{                        //取消赞                        numval = $('#num'+id).html();                        $('#num'+id).text(parseInt(numval)-1);                        $('#num'+id).attr('va','1');                        $.ajax({                            url:"{:url('bbc/minulaud')}",                            type:"post",                            dataType:"html",                            data:{id:id},                            success:function(data){                                layer.msg('取消成功', {time: 1000})                            }                        });                    }                }            </script>        </div>        <div class="hot_t_message" style="margin-top:10px; display: none">            <input type="hidden" value="{$vo.id}"/>            <textarea placeholder="请输入留言内容.." style="margin-top: 2px;" name="content"></textarea>            <a class="fb_btn" onclick="two(this,{$vo.id})">发布留言</a>            <p class="mess_title" style="margin-top: 40px;">全部留言</p>            {if condition="$vo['two']" neq ''}            {volist name="$vo['two']" id="vv"}            <div class="mess">                <div class="mess_d1">                    <img src="{$vv.picurl}" class="tx">                    <p class="name">{$vv.username}</p>                    <p class="hf" onclick="three(this,{$vv.id},{$vv.id})"><img src="__HOME__/img/hf_logo_03.png"><span>回复                    </span></p>                </div>                <p class="pj">{$vv.content}</p>                <p class="time">1F<span>{$vv.create_time|date="Y-m-d H:i:s",###}</span></p>                {if condition="$vv['reply'] neq ''"}                {volist name="$vv['reply']" id="vvv"}                <p class="hf1" onclick="four(this,{$vv.id},{$vvv.id})">{$vvv.username} 回复                    {$vvv.reply_user}：{$vvv.content}</p>                <!--这少一个div,但是加上就不好使-->                {/volist}                {/if}            </div>            {/volist}            {/if}        </div>        {/volist}        <div class="rt_hf" style="display: none">            <img src="__HOME__/img/hf_logo1_03.png" style="width: 0.4rem;margin-top:0.22rem;float: right;" alt=""                 id="huifu">            <input type="hidden" value="" id="answer_id">            <input type="hidden" value="" id="reply_id">            <input type="text" placeholder="说点什么吧..." value="" id="content">        </div>    </div>    {if condition="$jinbao == 1"}    <div class="down_footer">        <div class="down_footer_top">            <img src="__HOME__/img/logo.png" alt="" class="logo">            <a href="javascript:void(0);" class="down_link">立即下载</a>        </div>    </div>    {else /}    {/if}    {if condition="$id eq $user_id"}    <div class="details_btn" style="position: fixed!important;background: #fff;"><a href="javascript:void(0)">删除问题</a></div>    {/if}    <script>        $('.details_btn').click(function(){            var id = '{$data.id}';            $.ajax({                url: "{:url('bbc/dele')}",                type: 'post',                dataType: 'json',                data:{id:id},                success:function(data){                    layer.msg('删除成功!', {                        time: 2000 //2秒关闭（如果不配置，默认是3秒）                    }, function(){                        // window.location.href="<?php echo url('bbc/index'); ?>";                        window.location.href = document.referrer;                        // window.history.go(-1);                    });                }            })        })    </script></div></body></html><script>    function show_message(obj) {        $(".rt_hf").css("display", "none");        var all_message = $(obj).parent().parent().parent().parent().next("div");        if (all_message.css('display') == 'none') {            all_message.css("display", "block");        } else {            all_message.css("display", "none");        }    }    function two(obj, answer_id) {        var content = $(obj).prev().val();        var question_id = '{$data.id}';        $.ajax({            url: "{:url('bbc/replyAdd')}",            type: 'post',            dataType: 'json',            data: {question_id: question_id, content: content, answer_id: answer_id},            success: function (data) {                if (data.code == 200) {                    layer.msg('提交成功!', {                        time: 2000 //2秒关闭（如果不配置，默认是3秒）                    }, function () {                        $(".mess").load(location.href + " .hot_t_div1");                    });                } else {                    layer.msg(data.message);                }            }        });    }    var chickable_three = 0;    function three(obj, answer_id, reply_id) {        $(".rt_hf").css("display", "block");        $("#answer_id").val(answer_id);        $("#reply_id").val(reply_id);        $("#huifu").on('click', function () {            var answer_ids = $("#answer_id").val();            var reply_ids = $("#reply_id").val();            var question_id = '{$data.id}';            var content = $("#content").val();            if (chickable_three == 0) {                chickable_three = 1;                $.ajax({                    url: "{:url('bbc/replyAgainAdd')}",                    type: 'post',                    dataType: 'json',                    data: {question_id: question_id, content: content, answer_id: answer_ids, reply_id: reply_ids},                    success: function (data) {                        if (data.code == 200) {                            layer.msg('提交成功!', {                                time: 2000 //2秒关闭（如果不配置，默认是3秒）                            }, function () {                                $(".mess").load(location.href + " .hot_t_message");                            });                        } else {                            layer.msg(data.message);                        }                    }                });            }        })    }    var chickable_four = 0;    function four(obj, answer_id, reply_id) {        $(".rt_hf").css("display", "block");        $("#answer_id").val(answer_id);        $("#reply_id").val(reply_id);        $("#huifu").on('click', function () {            var answer_ids = $("#answer_id").val();            var reply_ids = $("#reply_id").val();            var question_id = '{$data.id}';            var content = $("#content").val();            if (chickable_four == 0) {                chickable_four = 1;                $.ajax({                    url: "{:url('bbc/replyAgainAdd')}",                    type: 'post',                    dataType: 'json',                    data: {question_id: question_id, content: content, answer_id: answer_ids, reply_id: reply_ids},                    success: function (data) {                        if (data.code == 200) {                            layer.msg('提交成功!', {                                time: 2000 //2秒关闭（如果不配置，默认是3秒）                            }, function () {                                $(".mess").load(location.href + " .hot_t_message");//                                $(obj).parent.location.reload()                            });                        } else {                            layer.msg(data.message);                        }                    }                });            }        })    }    function sc(id, type) {        $.ajax({            url: "{:url('collection/add')}",            type: 'post',            dataType: 'json',            data: {collection_id: id, type: type},            success: function (data) {                if (data.code == 200) {                    layer.msg('收藏成功!', {                        time: 2000 //2秒关闭（如果不配置，默认是3秒）                    }, function () {                        window.location.reload()                    });                } else {                    layer.msg(data.message);                }            }        });    }    function qx(collection_id) {        $.ajax({            url: "{:url('collection/del')}",            type: 'post',            dataType: 'json',            data: {collection_id: collection_id},            success: function (data) {                if (data.code == 200) {                    layer.msg('取消成功!', {                        time: 2000 //2秒关闭（如果不配置，默认是3秒）                    }, function () {                        window.location.reload()                    });                } else {                    layer.msg(data.message);                }            }        });    }</script><script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script><script type="text/javascript">    function fff() {        $(".layer1").hide();    }    function share_btn() {        $(".layer1").show();    }    var url = "{$url}";    wx.config({        debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。        appId: '{$share.appId}', // 必填，公众号的唯一标识        timestamp: "{$share.timestamp}", // 必填，生成签名的时间戳        nonceStr: '{$share.nonceStr}', // 必填，生成签名的随机串        signature: '{$share.signature}',// 必填，签名，见附录1        jsApiList: [            // 所有要调用的 API 都要加到这个列表中            'onMenuShareAppMessage',            'onMenuShareTimeline',        ] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2    });    wx.ready(function () {        wx.onMenuShareAppMessage({            title: '【万淘装备】论坛问答分享 ',            desc: '{$data.title}',            link: url,            type: 'link', // 分享类型,music、video或link，不填默认为link            imgUrl: '{$data.picurl}', // 分享图标            dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空            success: function () {                layer.msg("分享成功");                location.reload();            },            cancel: function () {                layer.msg("取消成功");                location.reload();            }        });        wx.onMenuShareTimeline({            title: '【万淘装备】论坛问答分享 ',            desc: '{$data.title}',            link: url,            type: 'link', // 分享类型,music、video或link，不填默认为link            imgUrl: '{$data.picurl}', // 分享图标            dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空            success: function () {                layer.msg("分享成功");                location.reload();            },            cancel: function () {                layer.msg("取消成功");            }        });    });</script>