<!--顶部导航-->{include file="public/header" /}    <style>        .check_nm label{            margin-top: 0.25rem;        }        .product .pro_right{            width: 3.65rem;        }        .check_nm label{            margin-right: 0.25rem;        }        .product .pro_right .name{            margin-left: 0;            line-height: 0.3rem;            color: #4c4c4c;            margin-bottom: 0.15rem;        }        .product .pro_right .price{            margin-top: 0.1rem;        }        .product .pro_right .price span{            font-size: 0.3rem;            line-height: 0.5rem;            margin-left: 0;        }        .product .pro_right .price .num{            font-size: 0.26rem;            color: #4c4c4c;            float: right;        }        .product{            padding-right: 0;        }    </style><body style="background: #f4f4f4"><div class="wrap">    <header>        <img src="__HOME__/img/back_btn_03.png" class="back_btn">        <p class="title">购物车</p>        <a href="{:url('car/index')}"><span class="right_span">完成</span></a>    </header>    <div class="shopcar_content">        {volist name="data" id="vo"}        <div class="d1">            <div class="nav">                <div class="check_nm">                    <input type="checkbox" id="input3_{$vo.store_id}" name="radio1" onclick="store('{$vo.store_id}')">                    <label for="input3_{$vo.store_id}"></label>                </div>                <p class="name">{$vo.title}</p>            </div>            {volist name="vo.goods" id="vv"}            <div class="product">                <div class="check_nm">                    <input type="checkbox" id="input1_{$vv.id}" onclick="goods('{$vv.id}','{$vv.store_id}')" value="{$vv.id}" class="{$vv.store_id}">                    <label for="input1_{$vv.id}" style="margin-top: 0.6rem"></label>                </div>                <img src="__ROOT__{$vv.picurl}" alt="" class="left_img">                <div class="product_right1">                    <p class="name">{$vv.title}</p>                    <ul>                        <li onclick="reduce('{$vv.id}')">-</li>                        <li id="{$vv.id}">{$vv.num}</li>                        <li onclick="add('{$vv.id}')">+</li>                    </ul>                    <input type="text"  id="finish_attr{$vv.id}"                           onclick="join_shop('{$vv.id}','{$vv.goods_id}','{$vv.attr}','{$vv.price}')"                           value="{$vv.attr}" style="border: 1px solid #dedede;width: 2.83rem;height: 0.45rem;margin-top: 0.05rem ;text-align: center;"                           readonly>                </div>                <p class="right1_complete" onclick="finish('{$vv.id}')">完成</p>            </div>            {/volist}        </div>        {/volist}    </div>    <!--底部结算-->    <div class="bottom_js">        <div class="check_nm" >            <input type="checkbox" id="input4" name="radio1">            <label for="input4" style="margin-top: 0.28rem;margin-right: 0.2rem;margin-left: 0.25rem"></label>        </div>        <span class="span1" onclick="all_choose()">全选</span>        <button class="js_btn" onclick="del()">删除</button>    </div>    <!--顶部导航-->    {include file="public/footer" /}    <!--顶部导航-->    <!--加入购物车弹框-->        <div class="join_shopcar_layer">        </div></div></body></html><script>    /*全选*/    function all_choose(){        if($("#input4").is(':checked')){            $("input[type='checkbox']").removeAttr("checked");        }else{            $("input[type='checkbox']").attr("checked",true);        }    }    $(".join_shopcar_layer .content .d2 .cans li").click(function(){        $(this).addClass("cans_style").siblings().removeClass("cans_style");    })    $(function () {        $(".join_shopcar_layer .content .d2 .cans li").live("click",function(){            $(this).addClass("cans_style").siblings().removeClass("cans_style");        })    })//属性关闭    $(".shopcar_close").live("click",function(){        $(".join_shopcar_layer").hide();    })//    点击属性，弹出属性选择框    function join_shop(id,goods_id,attr,price){        $.ajax({            url: "{:url('car/chooseArr')}",            type: 'post',            dataType: 'html',            data:{car_id:id,goods_id:goods_id,attr:attr,price:price},            success: function (data) {                $(".join_shopcar_layer").empty();                $(".join_shopcar_layer").append(data);            }        });        $(".join_shopcar_layer").show();    }//商品名称隐藏    $('.name').each(function() {        var words = $(this).text().length;        if(words > 15){            $(this).text($(this).text().slice(0,19)+"...");        }    });    /*加入购物车选择属性*/    function attr(id){        var str='';        $(".join_shopcar_layer").find("li").each(function(){            if( $(this).hasClass("cans_style")){                str+=$(this).text()+'_';            }        })        if (str.length > 0) {            str = str.substr(0, str.length - 1);        }        var car_num = $("#car_num").text();        $.ajax({            url: "{:url('goods/chooseAttrs')}",            type: 'post',            dataType: 'json',            data:{str:str,id:id},            success: function (data) {                if(data.code==200){                    $(".price").text('¥'+data.price);                }else{                }            }        });    }    /*点击店铺*/    function store(id){        if($("#input3_"+id).is(':checked')){            $("input."+id).attr("checked",true);            if($("input[name='radio1']:checked").length==$("input[name='radio1']").length){                $("#input4").attr("checked",true);            }        }else{            $("input."+id).removeAttr("checked");            $("#input4").removeAttr("checked");        }    }    /*点击商品*/    function goods(id,sotre_id) {        if($("input[class="+sotre_id+"]:checked").length==$("input[class="+sotre_id+"]").length){            $("#input3_"+sotre_id).attr("checked",true);            if($("input[name='radio1']:checked").length==$("input[name='radio1']").length){                $("#input4").attr("checked",true);            }        }else{            $("#input3_"+sotre_id).removeAttr("checked");            $("#input4").removeAttr("checked");        }    }//    数量++    function add(id){        var car_num = $("#"+id).text();        var car_nums = ++car_num;        $("#"+id).text(car_nums);    }//    数量--    function reduce(id){        var car_num = $("#"+id).text();        if (car_num>1){            var car_nums = --car_num;            $("#"+id).text(car_nums);        }    }//选择了属性，更改购物车的属性    function choose(id){        var str='';        $(".join_shopcar_layer").find("li").each(function(){            if( $(this).hasClass("cans_style")){                str+=$(this).text()+'_';            }        })        if (str.length > 0) {            str = str.substr(0, str.length - 1);        }        $.ajax({            url: "{:url('car/editAttr')}",            type: 'post',            dataType: 'json',            data:{attr:str,id:id,num:''},            success: function (data) {                if(data.code==200){                    $("#finish_attr"+id).val(str);                }else{                }            }        });        $(".join_shopcar_layer").hide();    }//    点击单个的完成function finish(id){    var num=$("#"+id).text();    $.ajax({        url: "{:url('car/editAttr')}",        type: 'post',        dataType: 'json',        data:{id:id,num:num,attr:''},        success: function (data) {            if(data.code==200){                layer.msg('修改成功!');            }else{            }        }    });}function del(){    var id='';    $("div.product").each(function(){        var str = $(this).find('input:checked').val();            id+=str+',';    })    $.ajax({        url: "{:url('car/del')}",        type: 'post',        dataType: 'json',        data:{id:id},        success: function (data) {            if(data.code==200){                layer.msg('删除成功!', {                    time: 2000 //2秒关闭（如果不配置，默认是3秒）                }, function(){                    window.location.reload()                });            }else{                layer.msg(data.message);            }        }    });}</script>