{include file="public/header" /}<body><div id="page">    <!--banner开始-->    <div class="swiper-container1">        <div class="swiper-wrapper">            {volist name="data['picarr']" id="vo"}            <div class="swiper-slide"><img src="__ROOT__{$vo.img}" style="height: 5.38rem;"></div>            {/volist}        </div>        <div class="swiper-pagination1"></div>    </div>    <!--banner结束-->    <div class="wp30">        <div class="proxx_ti">{$data['title']}</div>        <div class="proxx_jg"><span>￥</span><span style="font-size: 0.32rem;" id="price">{$data['sellprice']}</span><span>&nbsp;&nbsp;采购价</span></div>        <div class="proxx_sm">建议零售价<span>{$data['saleprice']}</span>库存：<span id="kucun">{$data['kucun_all']}</span></div>        <div class="in_ti" style="margin-bottom:0"><a href="javascript:void(0)" class="xuan_gg">选择规格            <span id="xzgg"></span><span id="xzsl"></span></a>        </div>    </div>    <div class="gg_showbg">        <a href="javascript:void(0)" class="xuan_guan"></a>            <div class="gg_show">                <p>规格</p>                {volist name="$data['attr']" id="vo"}                <div class="gg_xz"><!--选择{$vo.title}-->                        {volist name="$vo['attrs']" id="vv"}                        {if condition="$i eq 1"}                            <!--choose({$data['id']})-->                            <input name="gg" type="radio" value="" onclick="xzgg('{$vv}')"><span>{$vv}</span>                        {else/}                            <input name="gg" type="radio" value="" onclick="xzgg('{$vv}')"><span>{$vv}</span>                        {/if}                        {/volist}                    <div class="clear"></div>                </div>                {/volist}                <p>数量</p>                <div class="gg_shu">                    <input name="" type="button" onclick="numreduce()"  value="-">                    <input name="" type="text" id="buy_num" disabled value="1" class="gg_bian">                    <input name="" type="button" onclick="numadd()" value="+">                </div>                <input id="now_price" value=""/>    </div></div><div class="danxx_ti">商品详情</div><div class="danxx">    {$data.content}</div>    <div class="pb100"></div>    <!--底部nav开始-->    <div class="nfooter">        <ul>            <li><a href="{:url('index/index')}"><img src="__HOME__/images/home.png"><p>首页</p></a></li>            <li><a href="tel:{$web_hotline}"><img src="__HOME__/images/kefu.png"><p>客服</p></a></li>            <li><a href="javascript:void(0);" onclick="add_car({$data['id']})">加入购物车</a></li>            <li><a href="javascript:void(0);" onclick="add_now({$data['id']})">立即购买</a></li>        </ul>        <div class="clear"></div>    </div>    <!--底部nav结束--></div></body></html><script>    var swiper = new Swiper('.swiper-container', {        autoplay:true,        pagination: {            el: '.swiper-pagination'        },        loop:true,        navigation: {            nextEl: '.swiper-button-next',            prevEl: '.swiper-button-prev',        },    });    $(function() {        $(".gg_xz input").click(function () {            $(this).next("span").addClass("cans_style").siblings().removeClass("cans_style");        })    })    $(".xuan_gg").click(function(){        $(".gg_showbg").show();        sl = $('#xzsl').text()        if(sl==''){            $('#xzsl').text(1)        }        $("html").css({overflow:"hidden"})    })    $(".xuan_guan").click(function(){        $(".gg_showbg").hide();        //计算选中的金额        choose({$data['id']})        $("html").css({overflow:"scroll"})    })    function xzgg(tit){        $('#xzgg').text(tit)    }    function xzsl(tit){        $('#xzsl').text(tit)    }   /*选择属性数量 变化金额*/    function choose(id){        var str='';           $(".gg_xz").find("span").each(function(){               if( $(this).hasClass("cans_style")){                   str+=$(this).text()+'_';               }           })        if (str.length > 0) {            str = str.substr(0, str.length - 1);        }        if(str == ''){               return false;        }        var buy_num = $("#buy_num").val();        $.ajax({            url: "{:url('goods/chooseAttrs')}",            type: 'post',            dataType: 'json',            data:{str:str,id:id,buy_num:buy_num},            success: function (data) {                if(data.code==200){                     $("#price").text(data.price);                     $("#now_price").val(data.price);                     $("#kucun").text(data.kucun);                }else{                    layer.msg('选择参数失败，请重新选择!', {                        time: 2000 //2秒关闭（如果不配置，默认是3秒）                    }, function(){                        //window.location.href="{:url('address/index')}";                        window.location.reload()                    });                }            }        });    }    /*加入购物车*/    var chickable_car=0;//防止表单重复提交    function add_car(goods_id){        var str='';        $(".gg_xz").find("span").each(function(){            if( $(this).hasClass("cans_style")){                str+=$(this).text()+'_';            }        })        if (str.length > 0) {            str = str.substr(0, str.length - 1);        }        var buy_num = parseInt($("#buy_num").val());        if(buy_num == "" || buy_num<1){            tips('请选择数量');            return false;        }        kucun = parseInt($("#kucun").text());        if(kucun < buy_num){            tips('选择数量不能大于库存数量');            return false;        }        var price = $("#now_price").val();        if(price == ""){            tips('请选择规格');            return false;        }       // var yunfei =  $("#yunfei").val();        if(chickable_car==0){            chickable_car=1;        $.ajax({            url: "{:url('car/add')}",            type: 'post',            dataType: 'json',            data:{attr:str,goods_id:goods_id,num:buy_num,price:price},            success: function (data) {                if(data.code==200){                    layer.msg('提交成功!', {                        time: 2000 //2秒关闭（如果不配置，默认是3秒）                    }, function(){                        //window.location.href="{:url('address/index')}";                        window.location.reload()                    });                }else{                }            }        });        }    }    /*加入购物车选择数量++*/    function numadd(){         var buy_num = $("#buy_num").val();         var buy_nums = ++buy_num;         $("#buy_num").val(buy_nums);         $("#xzsl").text(buy_nums)    }    /*加入购物车选择数量—*/    function numreduce(){        var buy_num = $("#buy_num").val();        if (buy_num>1){            var buy_nums = --buy_num;            $("#buy_num").val(buy_nums);            $("#xzsl").text(buy_nums)        }    }    /*立即购买*/    chickable_now=0;    function add_now(goods_id){        var str='';        /*去属性*/        $(".gg_xz").find("span").each(function(){            if( $(this).hasClass("cans_style")){                str+=$(this).text()+'_';            }        })        if (str.length > 0) {            str = str.substr(0, str.length - 1);        }        var buy_num = parseInt($("#buy_num").val());        if(buy_num == "" || buy_num<1){            tips('请选择数量');            return false;        }        kucun = parseInt($("#kucun").text());        if(kucun < buy_num){            tips('选择数量不能大于库存数量');            return false;        }        var price = $("#now_price").val();        if(price == ""){            tips('请选择规格');            return false;        }        var yunfei = 0;        if(chickable_now==0){            chickable_now=1;            window.location.href="{:url('goods/create_order')}?attr="+str+"&goods_id="+goods_id+"&num="+buy_num+"&freight="+yunfei+"&price="+price;        }    }    function sc(id,type){        $.ajax({            url: "{:url('collection/add')}",            type: 'post',            dataType: 'json',            data:{collection_id:id,type:type},            success: function (data) {                if(data.code==200){                    layer.msg('收藏成功!', {                        time: 2000 //2秒关闭（如果不配置，默认是3秒）                    }, function(){                        window.location.reload()                    });                }else{                    layer.msg(data.message);                }            }        });    }    function qx(collection_id){        $.ajax({            url: "{:url('collection/del')}",            type: 'post',            dataType: 'json',            data:{collection_id:collection_id},            success: function (data) {                if(data.code==200){                    layer.msg('取消成功!', {                        time: 2000 //2秒关闭（如果不配置，默认是3秒）                    }, function(){                        window.location.reload()                    });                }else{                    layer.msg(data.message);                }            }        });    }</script><script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script><script type="text/javascript">    function fff() {        $(".layer1").hide();    }    function share_btn(){        $(".layer1").show();    }    var url = "{$url}";    wx.config({        debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。        //{$share.appId}        appId: '', // 必填，公众号的唯一标识        //{$share.timestamp}        timestamp:"" , // 必填，生成签名的时间戳        //{$share.nonceStr}        nonceStr: '', // 必填，生成签名的随机串        //{$share.signature}        signature: '',// 必填，签名，见附录1        jsApiList: [            // 所有要调用的 API 都要加到这个列表中            'onMenuShareAppMessage',            'onMenuShareTimeline',        ] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2    });    wx.ready(function(){        wx.onMenuShareAppMessage({            title: '',            desc: '{$data.title}',            link: url,            type: 'link', // 分享类型,music、video或link，不填默认为link            imgUrl: '{$data.picurl}', // 分享图标            dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空            success: function () {                layer.msg("分享成功");                location.reload();            },            cancel: function () {                layer.msg("取消成功");            }        });        wx.onMenuShareTimeline({            title: '',            desc: '{$data.title}',            link: url,            type: 'link', // 分享类型,music、video或link，不填默认为link            imgUrl: '{$data.picurl}', // 分享图标            dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空            success: function () {                layer.msg("分享成功");                location.reload();            },            cancel: function () {                layer.msg("取消成功");            }        });    });</script>