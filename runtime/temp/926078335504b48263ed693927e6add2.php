<?php if (!defined('THINK_PATH')) exit(); /*a:3:{s:83:"D:\phpstudy\WWW\20190213zihaimeirong\public/../application/home\view\car\index.html";i:1551921950;s:87:"D:\phpstudy\WWW\20190213zihaimeirong\public/../application/home\view\public\header.html";i:1551084136;s:87:"D:\phpstudy\WWW\20190213zihaimeirong\public/../application/home\view\public\footer.html";i:1551231545;}*/ ?>
<!--顶部导航--><!DOCTYPE html>    <html>    <head>        <meta charset="utf-8">        <meta http-equiv="X-UA-Compatible" content="IE=edge">        <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />        <title><?php echo $title; ?></title>        <link rel="stylesheet" type="text/css" href="__HOME__/css/base.css"/>        <link rel="stylesheet" href="__HOME__/css/swiper.min.css">        <script type="text/javascript" src="__HOME__/js/jquery-1.8.3.min.js"></script>        <script src="__HOME__/js/swiper.min.js"></script>        <script src="__HOME__/js/rem.js"></script>        <script src="__HOME__/js/jquery.validate.js"></script>        <script src="__HOME__/js/jquery.citys.js"></script>        <script src="__HOME__/js/layer/layer.js"></script>        <script src="__PLUGIN__/Fileinput/js/fileinput.js" type="text/javascript"></script>        <script>            $(function(){                var mySwiper = new Swiper('.swiper-container1',{                    pagination: '.swiper-pagination1',                    autoplay:3000,                    loop:true,                    grabCursor: true,                    paginationClickable: true                })            });            function tips(data) {                /*layer.open({                 content: data                 });*/                layer.msg(data);            }            // $(function(){            //     $(".back_btn").click(function(e){            //         //代码段            //         window.history.go(-1);            //         // window.location.href = document.referrer;            //     });            // });        </script>    </head><body class="bgfafafa"><div id="page">    <!--分类-->    <?php if(is_array($data) || $data instanceof \think\Collection): $i = 0; $__LIST__ = $data;if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$vv): $mod = ($i % 2 );++$i;?>    <!--一组-->    <div class="ding_list">            <input type="hidden" value="<?php echo $vv['id']; ?>">            <div class="gou_xuan">                <input type="checkbox" id="input1_<?php echo $vv['id']; ?>" iprice="<?php echo $vv['price']; ?>" value="<?php echo $vv['id']; ?>"  >                <label for="input1_<?php echo $vv['id']; ?>"></label>            </div>        <a href="<?php echo url('goods/info'); ?>?id=<?php echo $vv['goods_id']; ?>">            <div class="ding_list_tu"><img src="<?php echo $vv['picurl']; ?>"></div>        </a>            <div class="ding_list_zi">                <div class="ding_list_ti"><?php echo $vv['title']; ?></div>                <div class="gou_gg">规格：<?php echo $vv['attr_one']; ?>  <?php echo $vv['attr_two']; ?></div>                <div class="gou_jg"><font>￥</font><?php echo $vv['price']; ?></div>            </div>            <div class="gou_shu">                <input class="none jian" cid="<?php echo $vv['id']; ?>"  name="" type="button" value="-">                <div class="ls_css gou_num" style="display: inline-block;">                    <span class="xx">x</span>                    <span id="num<?php echo $vv['id']; ?>" class="success"  istatus="0" iid="<?php echo $vv['id']; ?>" inum="<?php echo $vv['num']; ?>"><?php echo $vv['num']; ?></span>                </div>                <input type="hidden" id="kucun<?php echo $vv['id']; ?>" value="<?php echo $vv['kucun']; ?>">                <input class="none jia" cid="<?php echo $vv['id']; ?>" name="" type="button" value="+">            </div>            <div class="clear"></div>    </div>    <?php endforeach; endif; else: echo "" ;endif; ?>    <!--一组-->    <div class="pb100"></div>    <div class="pb100"></div>    <div class="pb100"></div>    <div class="go_foot">        <div class="go_fxuan">            <input type="checkbox" id="input4">            <label for="input4" style="margin-top: 0.28rem;" ></label>        </div>        <div class="go_fzi">            <span class="span1" onclick="all_choose()" id="all_choose">                全选            </span>            <span id="foot_all">总计：¥ <span id="zong">00.00</span></span>        </div>        <div class="go_fsuan">            <div id="go_bj">编辑</div>            <div id="go_del" class="none">删除</div>        </div>        <div class="go_fsuan">            <input type="button" id="go_buy" onclick="jiesuan()" value="结算">            <input type="button" id="go_success" class="none" value="完成">        </div>    </div>    <!--底部nav开始-->    <div class="pb100"></div><!--底部nav开始--><div class="footer">    <ul>        <?php if($mo_foot == 1): ?>            <li id="mo_foot"><a href="<?php echo url('index/index'); ?>"><img  src="__HOME__/images/ft11.png" ><p>首页</p></a></li>        <?php else: ?>            <li><a href="<?php echo url('index/index'); ?>"><img  src="__HOME__/images/ft1.png" ><p>首页</p></a></li>        <?php endif; if($mo_foot == 2): ?>            <li id="mo_foot"><a href="<?php echo url('car/index'); ?>"><img src="__HOME__/images/ft22.jpg"><p>购物车</p></a></li>        <?php else: ?>            <li><a href="<?php echo url('car/index'); ?>"><img src="__HOME__/images/ft2.png"><p>购物车</p></a></li>        <?php endif; if($mo_foot == 3): ?>            <li id="mo_foot"><a href="<?php echo url('user/index'); ?>"><img src="__HOME__/images/ft33.jpg"><p>我的</p></a></li>        <?php else: ?>            <li><a href="<?php echo url('user/index'); ?>"><img src="__HOME__/images/ft3.png"><p>我的</p></a></li>        <?php endif; ?>    </ul>    <div class="clear"></div></div><!--底部nav结束--></div></body></html><script>    function tips(data) {        /*layer.open({         content: data         });*/        layer.msg(data);    }</script><script>    //删除    $('#go_del').click(function(){        //$('input:checkbox:checked') 等同于 $('input[type=checkbox]:checked')        //意思是选择被选中的checkbox        var str='';        var ids='';        $.each($('input:checkbox:checked'),function(){            ids = $(this).val();            if(ids != 'on'){                str += ids+',';            }        });        if (str.length > 0) {            str = str.substr(0, str.length - 1);        }else{            layer.msg('没有选择任何商品');            return false;        }        $.ajax({            url: "<?php echo url('car/del'); ?>",            type: 'post',            dataType: 'json',            data:{id:str},            success: function (data) {                if(data.code==200){                    layer.msg('删除成功!', {                        time: 500 //1秒关闭（如果不配置，默认是3秒）                    }, function(){                        window.location.reload()                    });                }else{                    layer.msg(data.message);                }            }        });        //confirm('确定要删除选中商品么？')    })    //编辑    $('#go_bj').click(function(){        $('#go_bj').addClass('none');        $('.xx').addClass('none');        $('#go_buy').addClass('none');        $('#go_del').removeClass('none');        $('#go_success').removeClass('none');        $('.jia').removeClass('none');        $('.jian').removeClass('none');        $('.ls_css').removeClass('ls_css');        $('#foot_all').addClass('none');    })    //完成    $('#go_success').click(function(){        var str_id  = '';        var str_num = '';        $.each($('.success'),function(){            id       = $(this).attr('iid');            num      = $(this).attr('inum');            istatus  = $(this).attr('istatus');            if(istatus == 1) {                str_id += id + ',';                str_num += num + ',';            }        });        if (str_id.length > 0) {            str_id  = str_id.substr(0, str_id.length - 1);            str_num = str_num.substr(0, str_num.length - 1);            $.ajax({                url: "<?php echo url('car/editAttr'); ?>",                type: 'post',                dataType: 'json',                data:{id:str_id,num:str_num},                success: function (data) {                    if(data.code==200){                        layer.msg('修改成功!', {                            time: 500 //1秒关闭（如果不配置，默认是3秒）                        }, function(){                            window.location.reload()                        });                    }else{                        layer.msg(data.message);                    }                }            });        }else{            $('#go_del').addClass('none');            $('#go_success').addClass('none');            $('.jia').addClass('none');            $('.jian').addClass('none');            $('.xx').removeClass('none');            $('#go_bj').removeClass('none');            $('#go_buy').removeClass('none');            $('#foot_all').removeClass('none');            $('.ls_css').addClass('ls_css');            return false;        }    })    /*全选*/    function all_choose(){        if($("#input4").is(':checked')){            $("input[type='checkbox']").removeAttr("checked");        }else{            $("input[type='checkbox']").attr("checked",true);        }        hj();    }    $("input[type='checkbox']").click(function(){        if($(this).attr('id') == 'input4'){            if($("#input4").is(':checked')){                $("input[type='checkbox']").attr("checked",true);            }else{                $("input[type='checkbox']").removeAttr("checked");            }        }else{            if($("input[type='checkbox']:not('#input4'):checked").length == $("input[type='checkbox']").length-1){                $("input[type='checkbox']").last().prop('checked',true)            }else{                $("input[type='checkbox']").last().prop('checked',false)            }        }        hj();    })    /*合计*/    function hj(){        var qian    = 0;        var danjia  = '';        var num     = '';        $.each($('input:checkbox:checked'),function(){            if($(this).attr('id') != 'input4') {                danjia = $(this).attr('iprice');                console.log(danjia);                id = $(this).val();                num = $('#num' + id).attr('inum');                qian += Number(danjia) * Number(num);            }        });        $("#zong").html(qian);    }   /*点击商品*/    function goods(id,sotre_id) {        hj();    }    //结算    function jiesuan(){        var str='';        var ids='';        $.each($('input:checkbox:checked'),function(){            ids = $(this).val();            if(ids != 'on'){                str += ids+',';            }        });        if (str.length > 0) {            str = str.substr(0, str.length - 1);        }else{            layer.msg('没有选择任何商品');            return false;        }        window.location.href="<?php echo url('car/car_order'); ?>?id="+str;    }    //加减购物车数量    $('.jia').click(function(){        cid   = $(this).attr('cid');        num   = parseInt($('#num'+cid).text());        kucun = parseInt($('#kucun'+cid).val());        if(kucun > num) {            $('#num' + cid).text(num + 1);            $('#num' + cid).attr('inum',num + 1);            $('#num' + cid).attr('istatus',1);        }else{            layer.msg('数量不能大于库存数量');        }    })    $('.jian').click(function() {        cid = $(this).attr('cid');        num = parseInt($('#num' + cid).text());        if (num > 1) {            $('#num' + cid).text(num - 1);            $('#num' + cid).attr('inum',num - 1);            $('#num' + cid).attr('istatus',1);        }else{            layer.msg('购物车数量不能小于1');        }    })</script>